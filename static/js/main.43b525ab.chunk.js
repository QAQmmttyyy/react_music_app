(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{161:function(e,t,a){e.exports=a.p+"static/media/loading-64.0ad8b01c.svg"},163:function(e,t,a){e.exports=a.p+"static/media/playall.8f22f49d.png"},166:function(e,t,a){e.exports=a(415)},171:function(e,t,a){},376:function(e,t,a){},385:function(e,t,a){},387:function(e,t,a){},389:function(e,t,a){},391:function(e,t,a){},405:function(e,t,a){},407:function(e,t,a){},409:function(e,t,a){},411:function(e,t,a){},413:function(e,t,a){},415:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(74),l=a.n(r),s=(a(171),a(164)),c=a(1),o=a(2),u=a(4),d=a(3),m=a(5),p=a(6),h=a(56),y=a.n(h),g=i.a.createContext(),f=(a(50),a(10)),v=a.n(f),E=a(13),S=(a(376),a(378),a(160)),k=a.n(S),w=a(11),b=a.n(w),x=(a(385),a(161)),N=a.n(x),P=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"loading"},i.a.createElement("img",{src:N.a,alt:"loading"}))}}]),t}(i.a.Component),C=(a(387),v.a.Item),O=C.Brief,j=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).submit=function(e){if(e){a.setState({showSearchKeywordBox:!1,showSearchResultBox:!0,isLoading:!0});var t=a.state.historyKeywords,n=[];t&&t.length?(n=t.slice(0)).push(e):n.push(e);var i=b.a.uniq(n);window.localStorage.setItem("historyKeywords",JSON.stringify(i));var r="https://api.mlwei.com/music/api/wy/?key=523077333&id=".concat(e,"&type=so&cache=1&nu=60"),l=encodeURI(r);window.fetch(l,{method:"GET",headers:{Accept:"*"},mode:"cors"}).then(function(e){return 200===e.status?e.json():{}}).then(function(e){var t=[];e.Body&&(t=e.Body.map(function(e){var t=e.author,a=e.id,n=e.pic,i=e.title;return{id:a,link:"/song?id=".concat(a),name:i,artists:[{name:t}],album:{picUrl:n}}})),a.setState({historyKeywords:i,searchResult:t,isLoading:!1})}).catch(function(e){console.log(e),a.setState({historyKeywords:n,isLoading:!1})})}},a.change=function(e){a.setState({keyword:e})},a.clear=function(){a.setState({keyword:""})},a.focus=function(){a.setState({showSearchBox:!0,showSearchKeywordBox:!0,showSearchResultBox:!1,isLoading:!1})},a.cancel=function(){a.setState({keyword:"",showSearchBox:!1,showSearchKeywordBox:!1,showSearchResultBox:!1,isLoading:!1})},a.handlePlaySong=function(e,t,n){e.stopPropagation(),t(b.a.cloneDeep(a.state.searchResult[n]))},a.handleClickKeyword=function(e){e.stopPropagation();var t=e.target.textContent;"item"===e.target.className&&(a.setState({keyword:t}),a.submit(t))},a.clearHistoryKeywords=function(e){e.stopPropagation(),window.localStorage.removeItem("historyKeywords"),a.setState({historyKeywords:[]})},a.state={keyword:"",hotKeywords:["\u8d77\u98ce\u4e86","A\u59b9\u65b0\u4e13\u8f91","\u6709\u53ef\u80fd\u7684\u591c\u665a","\u51fa\u5c71","\u6d41\u6d6a\u5730\u7403","Counting Sheep","\u7a7a\u5fc3","\u6c34\u661f\u8bb0","\u4e1c\u897f","\u68a6\u9f99"],historyKeywords:[],searchResult:[],showSearchBox:!1,showSearchKeywordBox:!1,showSearchResultBox:!1,isLoading:!1},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("historyKeywords");e&&this.setState({historyKeywords:JSON.parse(e)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.hotKeywords,n=t.historyKeywords,r=t.searchResult,l=t.showSearchBox,s=t.showSearchKeywordBox,c=t.showSearchResultBox,o=t.isLoading;return i.a.createElement(g.Consumer,null,function(t){var u,d=t.playSong;return u=r&&r.length?r.map(function(t,a){var n=t.id,r=t.name,l=t.artists;return i.a.createElement(C,{key:n,className:"result-list-item",activeStyle:{backgroundColor:"#ccc"},onClick:function(t){e.handlePlaySong(t,d,a)},multipleLine:!0},r,i.a.createElement(O,null,l.map(function(e){return e.name}).join("/")))}):i.a.createElement("div",{style:{height:"100vh",textAlign:"center"}},"\u7f51\u7edc\u51fa\u4e86\u70b9\u95ee\u9898"),i.a.createElement("div",{className:"my-search"},i.a.createElement(k.a,{ref:function(t){return e.manualFocusInst=t},value:e.state.keyword,cancelText:"\u8fd4\u56de",placeholder:"Search",onSubmit:e.submit,onChange:e.change,onClear:e.clear,onFocus:e.focus,onBlur:function(){return console.log("onBlur")},onCancel:e.cancel}),l?i.a.createElement("div",{className:"search-box"},i.a.createElement(E.Transition,{in:s,timeout:150,mountOnEnter:!0,unmountOnExit:!0},function(t){return i.a.createElement("div",{className:"search-keyword-box fade fade-".concat(t),onClick:function(t){return e.handleClickKeyword(t)}},i.a.createElement("div",{className:"hot-keyword"},i.a.createElement("h4",{className:"title"},"\u70ed\u95e8\u641c\u7d22"),i.a.createElement("ul",null,a.map(function(e,t){return i.a.createElement("li",{key:t,className:"item"},e)}))),n.length>0?i.a.createElement("div",{className:"history-keyword"},i.a.createElement("h4",{className:"title"},"\u641c\u7d22\u5386\u53f2",i.a.createElement("i",{className:"delete-btn",onClick:function(t){return e.clearHistoryKeywords(t)}})),i.a.createElement("ul",null,n.map(function(e,t){return i.a.createElement("li",{key:t,className:"item"},e)}))):null)}),i.a.createElement(E.Transition,{in:c,timeout:150,mountOnEnter:!0,unmountOnExit:!0},function(e){return i.a.createElement("div",{className:"search-result-box fade fade-".concat(e)},o?i.a.createElement(P,null):i.a.createElement(v.a,null,u))})):null)})}}]),t}(n.Component),L=a(75),I=(a(389),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).update=function(){a.slide&&a.slide.destroy(),a.init()},a.refresh=function(){a._setSlideWidth(!0),a.slide.refresh()},a.prev=function(){a.slide.prev()},a.next=function(){a.slide.next()},a.init=function(){window.clearTimeout(a.timer),a.setState({currentPageIndex:0}),a._setSlideWidth(),a.props.showDot&&a._initDots(),a._initSlide(),a.props.autoPlay&&a._play()},a._setSlideWidth=function(e){a.children=a.slideGroupRef.current.children;for(var t=0,n=a.slideRef.current.clientWidth,i=0;i<a.children.length;i++){var r=a.children[i];a.addClass(r,"slide-item"),r.style.width=n+"px",t+=n}a.props.loop&&!e&&(t+=2*n),a.slideGroupRef.current.style.width=t+"px"},a._initSlide=function(){a.slide=new L.a(a.slideRef.current,{scrollX:!0,scrollY:!1,momentum:!1,snap:{loop:a.props.loop,threshold:a.props.threshold,speed:a.props.speed},bounce:!1,stopPropagation:!0,click:a.props.click}),a.slide.on("scrollEnd",a._onScrollEnd),a.slide.on("touchEnd",function(){a.props.autoPlay&&a._play()}),a.slide.on("beforeScrollStart",function(){a.props.autoPlay&&window.clearTimeout(a.timer)})},a._onScrollEnd=function(){var e=a.slide.getCurrentPage().pageX;a.setState({currentPageIndex:e}),a.autoPlay&&a._play()},a._initDots=function(){for(var e=new Array(a.children.length),t=0;t<e.length;t++)e[t]=t;a.setState({dots:e})},a._play=function(){window.clearTimeout(a.timer),a.timer=window.setInterval(function(){a.slide.next()},a.props.interval)},a.hasClass=function(e,t){return new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},a.addClass=function(e,t){if(!a.hasClass(e,t)){var n=e.className.split(" ");n.push(t),e.className=n.join(" ")}},a.state={dots:[],currentPageIndex:0},a.slideRef=i.a.createRef(),a.slideGroupRef=i.a.createRef(),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.update(),window.addEventListener("resize",function(){e.slide&&e.slide.enabled&&(window.clearTimeout(e.resizeTimer),e.resizeTimer=window.setTimeout(function(){e.slide.isInTransition?e._onScrollEnd():e.props.autoPlay&&e._play(),e.refresh()},60))})}},{key:"componentWillMount",value:function(){window.clearTimeout(this.timer)}},{key:"render",value:function(){var e=this.state,t=e.dots,a=e.currentPageIndex;return i.a.createElement("div",{className:"slide",ref:this.slideRef},i.a.createElement("div",{className:"slide-group",ref:this.slideGroupRef},this.props.children),this.props.showDot?i.a.createElement("div",{className:"dots"},t.map(function(e,t){return i.a.createElement("span",{key:t,className:"dot ".concat(a===t?"active":"")})})):null)}}]),t}(n.Component));I.defaultProps={loop:!0,autoPlay:!0,interval:4e3,showDot:!0,click:!0,threshold:.3,speed:400};var B=I,T=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(i)))).state={banners:["https://p1.music.126.net/PzonwsvcSEEsr-uhJXE2_g==/109951163871296308.jpg","https://p1.music.126.net/thHP6ooWw893Ccfk_iXG5w==/109951163866743145.jpg","https://p1.music.126.net/VO_0urbXu_PytHjhjfj4Zw==/109951163871298888.jpg","https://p1.music.126.net/kEGOOxh_p6H7UHKuOOFkFg==/109951163871789068.jpg","https://p1.music.126.net/wa7Oxq5yysZgGBvOlivwEg==/109951163871318124.jpg"]},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.state.banners;return i.a.createElement(B,null,e.map(function(e,t){return i.a.createElement("div",{key:t},i.a.createElement("img",{src:e,alt:"banner"}))}))}}]),t}(n.Component),R=(a(391),function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.src,a=e.style,n=e.playCount;return i.a.createElement("div",{className:"pl-cover",style:a},i.a.createElement("img",{className:"cover",src:t,alt:"cover"}),i.a.createElement("span",{className:"u-earp play-num"},n))}}]),t}(i.a.Component)),A=(a(393),a(162)),D=a.n(A),U=(a(159),a(54)),_=a.n(U),F=(a(110),a(45)),K=a.n(F),M=a(163),W=a.n(M),H=(a(405),v.a.Item),G=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).getSonglist=function(){a.setState({isLoading:!0});var e="https://api.mlwei.com/music/api/wy/?key=523077333&cache=1&type=songlist&id=".concat(a.plId);window.fetch(e,{method:"GET",headers:{Accept:"*"},mode:"cors"}).then(function(e){return 200===e.status?e.json():{}}).then(function(e){var t=[];e.Body&&(t=e.Body.map(function(e){var t=e.id,a=e.title,n=e.author,i=e.pic;return{id:t,link:"/song?id=".concat(t),name:a,artists:[{name:n}],album:{picUrl:i}}})),a.setState({songlist:t,isLoading:!1})}).catch(function(e){console.log(e),a.setState({isLoading:!1})})},a.state={songlist:[],isLoading:!1},a.SWrapperRef=i.a.createRef(),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.getSonglist()}},{key:"handleClickPlayallOrAddall",value:function(e){e(b.a.cloneDeep(this.state.songlist))}},{key:"handlePlaySong",value:function(e,t,a){e.stopPropagation(),t(b.a.cloneDeep(this.state.songlist[a]))}},{key:"render",value:function(){var e=this,t=this.props,a=t.transitionClass,n=t.playlistIntro,r=t.toggleShowPlDetail,l=this.state,s=l.songlist,c=l.isLoading,o=n.id,u=n.coverUrl,d=n.name,m=n.playCount,p=n.author;return this.plId=o,i.a.createElement(g.Consumer,null,function(t){var n=t.playerState,l=t.playAll,o=t.playSong,h=n.currentSong.id,y=s.length&&s.map(function(t,a){var n=t.id,r=t.name,l=t.artists,s=t.album,c=l.map(function(e){return e.name}).join("/");return i.a.createElement(H,{key:n,className:"mty-list-item ".concat(n===h?"playing":""),activeStyle:{backgroundColor:"#ccc"},onClick:function(t){e.handlePlaySong(t,o,a)}},i.a.createElement("div",{className:"s-index"},a+1),i.a.createElement("div",{className:"s-detail-wrap"},i.a.createElement("div",{className:"s-info"},i.a.createElement("div",{className:"s-name f-thide"},r),i.a.createElement("div",{className:"s-artists-alb f-thide"},c," - ",s.name))))});return i.a.createElement("div",{className:"PlaylistDetail ".concat(a)},i.a.createElement("div",{className:"pld-navbar-wrapper"},i.a.createElement(_.a,{icon:i.a.createElement(K.a,{type:"left"}),onLeftClick:r},"\u6b4c\u5355")),i.a.createElement("div",{className:"scroll-wrapper",style:n.playingList.length?{paddingBottom:"56px"}:{paddingBottom:"0px"}},i.a.createElement("div",{className:"scroll-content"},i.a.createElement("section",{className:"my-plinfo-wrap"},i.a.createElement(R,{src:"".concat(u,"?param=336y336"),style:{width:"1.12rem",height:"1.12rem"},playCount:m}),i.a.createElement("div",{className:"plinfo-right"},i.a.createElement("h2",{className:"f-brk title"},d),i.a.createElement("div",{className:"author f-thide"},p.name))),i.a.createElement("div",{className:"playall-btn-wrapper"},i.a.createElement(H,{className:"mty-list-item",activeStyle:{backgroundColor:"#ddd"},onClick:function(){e.handleClickPlayallOrAddall(l)}},i.a.createElement("div",{className:"playall-btn"},i.a.createElement("img",{src:W.a,alt:"playicon"}),i.a.createElement("span",null,"\u64ad\u653e\u5168\u90e8"),i.a.createElement("span",{className:"song-num"},"\u5171(",s.length,")\u9996")))),i.a.createElement(v.a,{className:y?"":"no-content"},y||(c?i.a.createElement("div",{className:"loading-box"},i.a.createElement(P,null)):i.a.createElement("div",{className:"result-box"},i.a.createElement(D.a,{title:"\u7f51\u7edc\u5f00\u5c0f\u5dee\u4e86"})))))),i.a.createElement("div",{className:"bg-wrap"},i.a.createElement("div",{className:"fullscreen-blur-bg",style:{backgroundImage:"url(".concat(u,"?param=336y336)")}})))})}}]),t}(i.a.Component),X=v.a.Item,Z=X.Brief,J=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).toggleShowPlDetail=function(){a.setState(function(e){return{showPlDetail:!e.showPlDetail}})},a.handleClickPlaylist=function(e){var t=e.currentTarget;if(t.hasAttribute("data-index")){var n=t.getAttribute("data-index");a.setState(function(e){return{showPlDetail:!0,clickedPl:"rcmd"===t.getAttribute("data-plcate")?e.rcmdPlaylists[n]:e.playlists[n]}})}},a.getPlaylists=function(e){var t="".concat("/react_music_app","/api_mock_data/playlists/all/p").concat(e,".json");window.fetch(t).then(function(e){return 200===e.status?e.json():""}).then(function(e){a.setState({playlists:e})}).catch(function(e){return console.log(e)})},a.state={rcmdPlaylists:[{id:2406347748,coverUrl:"http://p2.music.126.net/tkQ6Zb_eBdUsFAeD6PM-2A==/109951163547241213.jpg",name:"2018\u5168\u7f8e\u97f3\u4e50\u5956\u63d0\u540d\u540d\u5355\uff08AMAs\uff09",link:"/playlist?id=2406347748",playCount:"126\u4e07",author:{name:"DoubleRainbow_",homeLink:"/user/home?id=3226705"}},{id:2439954234,coverUrl:"http://p2.music.126.net/dBdq_Rs_pexuA8GqkZLcKA==/109951163599919632.jpg",name:"\u542c\u9996\u60c5\u6b4c\u8bf4\u5531 | \u505a\u4e2a\u751c\u751c\u7684\u68a6",link:"/playlist?id=2439954234",playCount:"211\u4e07",author:{name:"\u7ae0\u82e5\u6960nn",homeLink:"/user/home?id=640698142"}},{id:2497731034,coverUrl:"http://p2.music.126.net/AtlN3uAvGczoL-xQN7FTtQ==/109951163643083559.jpg",name:"\u521d\u604b\u7cd6\u914d\u6599\u8868\uff1a\u4f60\u7684\u9a6c\u5c3e\u8fab\u548c\u886c\u886b\u5473\u9053",link:"/playlist?id=2497731034",playCount:"542\u4e07",author:{name:"\u9a74\u5b50\u9b3c",homeLink:"/user/home?id=246029257"}},{id:2390539027,coverUrl:"http://p2.music.126.net/8BZpZdDiDZatIiQMJnoKyg==/109951163736178562.jpg",name:"\u90a3\u4e9b\u8d85\u5e26\u611f\u7684\u82f1\u6587\u6b4c\u66f2~\u300e\u4e00\u79d2\u6ca6\u9677\u300f",link:"/playlist?id=2390539027",playCount:"351\u4e07",author:{name:"Mysterious-Box",homeLink:"/user/home?id=1558934331"}},{id:2554253084,coverUrl:"http://p2.music.126.net/mP8ulkyTDGmoj6jlZ_sblQ==/109951163722284832.jpg",name:"Future Bass\u4e28\u9189\u5bfb\u5fc3\u6da7\u8df3\u52a8\u7684\u68a6\u5e7b\u7535\u5b50\u26a1\ufe0f",link:"/playlist?id=2554253084",playCount:"61\u4e07",author:{name:"Kirin\u7535\u5b50\u7ad9",homeLink:"/user/home?id=1489420441"}},{id:2312165875,coverUrl:"http://p2.music.126.net/Cl0-NpZ0ESTDjJ1HmZ33KA==/109951163460576279.jpg",name:"100\u9996\u534e\u8bed\u6c11\u8c23\uff0c\u56e0\u4e3a\u61c2\u5f97\u624d\u6709\u5171\u9e23",link:"/playlist?id=2312165875",playCount:"1107\u4e07",author:{name:"\u60c5\u601d\u5929\u9e45",homeLink:"/user/home?id=108952364"}}],playlists:[],showPlDetail:!1,clickedPl:{}},a.curPage=0,a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.getPlaylists(this.curPage)}},{key:"render",value:function(){var e=this,t=this.state,a=t.rcmdPlaylists,n=t.playlists,r=t.showPlDetail,l=t.clickedPl,s=a.map(function(t,a){var n=t.id,r=t.coverUrl,l=t.name,s=t.playCount;return i.a.createElement("li",{key:n,className:"pl-li","data-index":a,"data-plcate":"rcmd",onClick:function(t){return e.handleClickPlaylist(t)}},i.a.createElement("div",{className:"cover-wrapper"},i.a.createElement(R,{src:"".concat(r,"?param=400y400"),style:{position:"absolute",top:0,left:0},playCount:s})),i.a.createElement("p",{className:"dec"},l))}),c=n&&n.map(function(t,a){var n=t.id,r=t.coverUrl,l=t.name,s=t.playCount,c=t.author;return i.a.createElement(X,{key:n,thumb:"".concat(r,"?param=200y200"),onClick:function(t){return e.handleClickPlaylist(t)},multipleLine:!0,"data-index":a,"data-plcate":"all"},l," ",i.a.createElement(Z,null,"".concat(c.name," \xb7 ").concat(s,"\u6b21\u64ad\u653e")))});return i.a.createElement(g.Consumer,null,function(t){var a=t.playerState;return i.a.createElement(i.a.Fragment,null,i.a.createElement(j,null),i.a.createElement("div",{className:"playlists",style:a.playingList.length?{paddingBottom:"56px"}:{paddingBottom:"0px"}},i.a.createElement(T,null),i.a.createElement("div",{key:"cate",className:"pl-cat"},"\u63a8\u8350\u6b4c\u5355"),i.a.createElement("ul",{key:"cvrlst",className:"pl-cvrlst"},s),i.a.createElement(v.a,{renderHeader:function(){return"\u5168\u90e8\u6b4c\u5355"}},c)),i.a.createElement(E.Transition,{in:r,timeout:150,mountOnEnter:!0,unmountOnExit:!0},function(t){return i.a.createElement(G,{transitionClass:"slide-up slide-up-".concat(t),playlistIntro:l,toggleShowPlDetail:e.toggleShowPlDetail})}))})}}]),t}(i.a.Component),q=a(55),z=a.n(q),Q=(a(407),v.a.Item),V=Q.Brief,$=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"render",value:function(){var e=this.props,t=e.transitionClass,a=e.curSong,n=e.isPauseIcon,r=e.clickPlayPauseHandler,l=e.toggleFullplayer,s=e.togglePlayingList,c=i.a.createElement("div",{className:"miniplayer-btns-wrapper"},i.a.createElement("div",{className:"btn ".concat(n?"pause":"play","-icon"),onClick:r}),i.a.createElement("div",{className:"btn playlist-icon",onClick:s})),o=null;if(b.a.isEmpty(a))o=i.a.createElement(Q,{className:"miniplayer-content",extra:c,multipleLine:!0},"\u542c\u6211\u60f3\u542c\u7684\u6b4c");else{var u=a.name,d=a.artists,m=a.album,p="";p=m.picUrl&&m.picUrl.length&&m.picUrl.includes("http")?"".concat(m.picUrl):z.a,o=i.a.createElement(Q,{className:"miniplayer-content",thumb:p,extra:c,onClick:l,activeStyle:{backgroundColor:"#fff"},multipleLine:!0},u,i.a.createElement(V,null,d.map(function(e){return e.name}).join("/")))}return i.a.createElement("div",{className:"miniplayer ".concat(t)},o)}}]),t}(n.Component),Y=(a(409),a(165)),ee=(a(411),function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,r=new Array(n),l=0;l<n;l++)r[l]=arguments[l];return(a=Object(u.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(r)))).SWrapperRef=i.a.createRef(),a.initScroll=function(){a.SWrapperRef.current&&(a.scroll=new L.a(a.SWrapperRef.current,{click:!0}))},a.refreshScroll=function(){a.scroll&&a.scroll.refresh()},a.destroyScroll=function(){a.scroll.destroy()},a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){this.initScroll()}},{key:"componentWillUnmount",value:function(){this.scroll&&this.scroll.destroy()}},{key:"scrollToElement",value:function(){this.scroll&&this.scroll.scrollToElement.apply(this.scroll,arguments)}},{key:"render",value:function(){var e=this.props,t=e.style,a=e.className,n=e.children,r=Object(Y.a)(e,["style","className","children"]);return i.a.createElement("div",Object.assign({ref:this.SWrapperRef,style:t,className:"scroll-wrapper ".concat(a)},r),n)}}]),t}(n.Component)),te=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).handleTouchStart=function(e,t,n){if(!b.a.isEmpty(a.curSong)){a.isTouching=!0;e.target;var i=a.ProgressBarRef.current;a.progressBarOffsetLeft=i.offsetLeft,a.touchmoveLeftEdge=a.progressBarOffsetLeft-8,a.touchmoveRightEdge=a.progressBarOffsetLeft+a.progressBarWidth+8,a.prevTouchX=e.targetTouches[0].clientX;var r=a.ProgressWrapRef.current;a.handleTouchEnd=a.handleTouchEnd.bind(Object(p.a)(Object(p.a)(a)),t),r.addEventListener("touchmove",a.handleTouchMove),r.addEventListener("touchend",a.handleTouchEnd),n()}},a.handleTouchMove=function(e){var t=e.touches[0].clientX;if(a.touchmoveLeftEdge<t&&t<a.touchmoveRightEdge){var n=t-a.prevTouchX;a.prevTouchX=t;var i=a.progress+n;i<0?i=0:i>a.progressBarWidth&&(i=a.progressBarWidth),a.progress=i,a.props.updateCurrentTime(i/a.progressBarWidth)}},a.handleClickLyric=function(){a.setState({showCover:!0,showLyric:!1})},a.handleClickCover=function(){a.setState({showCover:!1,showLyric:!0})},a.state={showCover:!0,showLyric:!1},a.ScrollRef=i.a.createRef(),a.ProgressWrapRef=i.a.createRef(),a.ProgressBarRef=i.a.createRef(),a.diffSong=!0,a.curLyricIndex=-1,a.curLyricIndexChange=!1,a.isTouching=!1,a.progress=0,a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=this.ProgressBarRef.current;this.progressBarWidth=e.clientWidth}},{key:"componentDidUpdate",value:function(){this.state.showLyric&&this.lyric.length&&(this.diffSong?this.ScrollRef.current.scrollToElement("p.sentence",1e3,!1,!0):this.curLyricIndexChange&&this.curLyricIndex>=5&&this.ScrollRef.current.scrollToElement("p.is-curSentence",1e3,!1,!0))}},{key:"handleTouchEnd",value:function(e,t){this.isTouching=!1;var a=this.ProgressWrapRef.current;a.removeEventListener("touchmove",this.handleTouchMove),a.removeEventListener("touchend",this.handleTouchEnd),e()}},{key:"render",value:function(){var e=this,t=this.props,a=t.transitionClass,n=t.curSong,r=t.diffSong,l=t.playState,s=t.mode,c=t.clickPlayPauseHandler,o=t.clickPrevBtnHandler,u=t.clickNextBtnHandler,d=t.clickModeBtnHandler,m=t.toggleFullplayer,p=t.togglePlayingList,h=this.state,y=h.showCover,f=h.showLyric;if(this.curSong=n,b.a.isEmpty(n))return i.a.createElement("div",{className:"fullplayer ".concat(a)},i.a.createElement(_.a,{className:"my-fullplayer-navbar",icon:i.a.createElement(K.a,{type:"down"}),onLeftClick:m},"\u542c\u6211\u60f3\u542c\u7684\u6b4c"),i.a.createElement("div",{className:"mid-wrapper"},i.a.createElement("div",{className:"cd-box"},i.a.createElement("div",{className:"cd-wrapper"},i.a.createElement("div",{className:"cd"},i.a.createElement("img",{className:"image",src:z.a}))))),i.a.createElement("div",{className:"background"}));n.id;var v=n.name,S=n.artists,k=n.album,w=l.duration,x=l.curTime,N=l.playProgress,P=l.isPauseIcon,C=l.lyric,O=l.curLyricIndex,j=l.curLyricIndexChange;this.diffSong=r,this.curLyricIndex=O,this.curLyricIndexChange=j,this.lyric=C;var L=i.a.createElement("div",{className:"navbar-title-content"},i.a.createElement("p",{className:"song-name f-thide"},v),i.a.createElement("p",{className:"artists-name f-thide"},"- ",S.map(function(e){return e.name}).join("/")," -")),I=null,B=0;C.length&&(I=C.map(function(e,t){var a="sentence".concat(t===O?" is-curSentence":"");return i.a.createElement("p",{id:t,key:t,style:""===e?{height:"18px"}:{},className:a},e)}),B=-40*C.length);var T="";T=k.picUrl&&k.picUrl.length&&k.picUrl.includes("http")?"".concat(k.picUrl):z.a;var R=this.progressBarWidth*parseFloat(N);return this.progress=R,i.a.createElement(g.Consumer,null,function(t){var n=t.play,r=t.pause;return i.a.createElement("div",{className:"fullplayer ".concat(a)},i.a.createElement(_.a,{className:"my-fullplayer-navbar",icon:i.a.createElement(K.a,{type:"down"}),onLeftClick:m},L),i.a.createElement(E.Transition,{in:y,timeout:100,mountOnEnter:!0,unmountOnExit:!0},function(t){return i.a.createElement("div",{className:"mid-wrapper fade fade-".concat(t)},i.a.createElement("div",{className:"cd-box",onClick:function(){return e.handleClickCover()}},i.a.createElement("div",{className:"cd-wrapper"},i.a.createElement("div",{className:"cd"},i.a.createElement("img",{className:"image",src:T})))))}),i.a.createElement(E.Transition,{in:f,timeout:100,mountOnEnter:!0,unmountOnExit:!0},function(t){return i.a.createElement(ee,{ref:e.ScrollRef,className:"lyric-wrapper fade fade-".concat(t),onClick:function(){return e.handleClickLyric()}},i.a.createElement("div",{className:"scroll-content"},I?i.a.createElement("div",{className:"lyric"},I):i.a.createElement("p",{className:"no-lyric"},"\u6682\u65e0\u6b4c\u8bcd")))}),i.a.createElement("div",{className:"btm-wrapper"},i.a.createElement("div",{className:"progress-wrapper",ref:e.ProgressWrapRef},i.a.createElement("p",{className:"time time-cur"},x),i.a.createElement("div",{className:"progress-bar-wrapper"},i.a.createElement("div",{ref:e.ProgressBarRef,className:"progress-bar"},i.a.createElement("div",{className:"bar-inner"},i.a.createElement("div",{className:"progress",style:{width:"".concat(e.isTouching?e.progress:R,"px")}}),i.a.createElement("div",{className:"progress-btn-wrapper",style:{transform:"translate3d(".concat(e.isTouching?e.progress:R,"px, 0px, 0px)")},onTouchStart:function(t){return e.handleTouchStart(t,n,r)}},i.a.createElement("div",{className:"progress-btn"}))))),i.a.createElement("p",{className:"time time-dur"},w)),i.a.createElement("div",{className:"operators"},i.a.createElement("div",{className:"btn ".concat(s,"-icon"),onClick:d}),i.a.createElement("div",{className:"btn prev-icon",onClick:o}),i.a.createElement("div",{className:"btn ".concat(P?"pause":"play","-icon"),onClick:c}),i.a.createElement("div",{className:"btn next-icon",onClick:u}),i.a.createElement("div",{className:"btn list-icon",onClick:p}))),i.a.createElement("div",{className:"background"},i.a.createElement("img",{width:"100%",height:"100%",src:T})))})}}]),t}(i.a.Component),ae=(a(413),v.a.Item),ne=function(e){function t(){return Object(c.a)(this,t),Object(u.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){window.document.querySelector(".playing-list .active-song").scrollIntoView()}},{key:"render",value:function(){var e=this.props,t=e.transitionClass,a=e.togglePlayingList;return i.a.createElement(g.Consumer,null,function(e){var n=e.playerState,r=e.playByIndex,l=e.deleteSong,s=e.clearPlaylist,c=n.playingList,o=n.curSongIndex,u=i.a.createElement("div",{className:"btn delete-icon",onClick:function(){return s()}}),d=c.map(function(e,t){var a=e.id,n=e.name,s=e.artists,c=i.a.createElement("div",{className:"btn close-icon",onClick:function(e){e.stopPropagation(),l(t)}});return i.a.createElement(ae,{key:a,className:"".concat(o===t?"active-song":""),extra:c,onClick:function(){return r(t)}},n,i.a.createElement("span",{className:"song-artists-alb"}," - "+s.map(function(e){return e.name}).join("/")))});return i.a.createElement("div",{className:"playing-list ".concat(t),onTouchStart:function(e){return e.stopPropagation()}},i.a.createElement(ae,{extra:u,multipleLine:!0},"\u64ad\u653e\u5217\u8868",i.a.createElement("span",{className:"song-num"},"\u5171(",c.length,")\u9996")),i.a.createElement(v.a,null,d),i.a.createElement(ae,{className:"close-btn",onClick:a,multipleLine:!0},"\u5173\u95ed"))})}}]),t}(i.a.Component),ie=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).getLyric=function(){var e="https://api.mlwei.com/music/api/wy/?key=523077333&cache=1&type=lrc&id=".concat(a.songId);console.log(e),window.fetch(e,{method:"GET",headers:{Accept:"*"},mode:"cors"}).then(function(e){return 200===e.status?e.text():null}).then(function(e){if(e){var t=e.split("\n"),n=[],i=[];t.forEach(function(e){var t=e.match(/\[(.*)\](.*)/);if(t){var a=t[1].trim().split(":"),r=60*parseInt(a[0])+parseFloat(a[1]);isNaN(r)||(n.push(t[2].trim()),i.push(r))}}),console.log(n),a.setState({lyric:n,timestampArr:i,curLyricIndex:-1})}}).catch(function(e){a.setState({lyric:[],timestampArr:[]})})},a.toggleFullplayer=function(){a.setState(function(e){return{showFullplayer:!e.showFullplayer}})},a.togglePlayingList=function(e){e.stopPropagation(),a.setState(function(e){return{showPlayingList:!e.showPlayingList}})},a.updateCurrentTime=function(e){var t=a.audioRef.current,n=t.duration;t.currentTime=n*e},a.state={modeIndex:0,duration:"00:00",curTime:"00:00",playProgress:"0",lyric:[],timestampArr:[],curLyricIndex:-1,curLyricIndexChange:!1,isPauseIcon:!1,showFullplayer:!1,showPlayingList:!1},a.audioRef=i.a.createRef(),a.songId=0,a.diffSong=!1,a.curSongIndex=-1,a.audioAmount=0,a.isPause=!0,a.songUrlApi="https://music.163.com/song/media/outer/url?id=",a.currentSong={},a.playMode=[{desc:"\u5217\u8868\u5faa\u73af",className:"loop"},{desc:"\u5355\u66f2\u5faa\u73af",className:"single"},{desc:"\u968f\u673a\u64ad\u653e",className:"random"}],a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){}},{key:"componentDidUpdate",value:function(){this.isNoAudio()||(this.isPause?this.audioRef.current.paused||this.pauseAudio():this.audioRef.current.paused&&this.playAudio(),this.diffSong&&this.getLyric())}},{key:"playAudio",value:function(){var e=this;this.audioRef.current.play().then(function(){e.setState({isPauseIcon:!0})},function(e){console.log(e)})}},{key:"pauseAudio",value:function(){this.audioRef.current.pause(),this.setState({isPauseIcon:!1})}},{key:"handleClickPlayPause",value:function(e,t,a){(e.stopPropagation(),this.isNoAudio())||(this.audioRef.current.paused?t(this.curSongIndex):a())}},{key:"handleClickPrevBtn",value:function(e){this.isNoAudio()||(this.setState({playProgress:"0"}),e(this.getIndex(!0)))}},{key:"handleClickNextBtn",value:function(e){this.isNoAudio()||(this.setState({playProgress:"0"}),e(this.getIndex()))}},{key:"handleClickModeBtn",value:function(){if(!this.isNoAudio()){var e=(this.state.modeIndex+1)%this.playMode.length;this.audioRef.current.loop=1===e,this.setState({modeIndex:e})}}},{key:"handleDurationChange",value:function(){this.setState({duration:this.timeFormat(this.audioRef.current.duration),playProgress:"0",curTime:"00:00"})}},{key:"handleTimeUpdate",value:function(){var e=this.state,t=e.curTime,a=e.curLyricIndex,n=e.timestampArr,i=this.audioRef.current,r=i.duration,l=i.currentTime,s=this.timeFormat(l),c="".concat((l/r).toFixed(3)),o=b.a.findLastIndex(n,function(e){return e<=l});t!==s?this.setState({curTime:s,playProgress:c}):l===r&&this.setState({playProgress:c}),a!==o?this.setState({curLyricIndex:o,curLyricIndexChange:!0}):this.setState({curLyricIndexChange:!1})}},{key:"handleEnded",value:function(e){var t=this.getIndex();this.setState({loadProgress:"0",playProgress:"0"}),e(t)}},{key:"handleAudioError",value:function(){var e=this.audioRef.current;console.log(e.error),2===e.error.code&&(e.load(),e.currentTime=parseFloat(this.state.playProgress)/100)}},{key:"isNoAudio",value:function(){return 0===this.audioAmount}},{key:"timeFormat",value:function(e){var t=parseInt("".concat(e/60)),a=parseInt("".concat(e%60)),n=t<10?"0".concat(t):"".concat(t),i=a<10?"0".concat(a):"".concat(a);return"".concat(n,":").concat(i)}},{key:"getIndex",value:function(e){void 0===e&&(e=!1);var t=0;switch(this.state.modeIndex){case 0:case 1:t=e?(this.curSongIndex-1+this.audioAmount)%this.audioAmount:(this.curSongIndex+1)%this.audioAmount;break;case 2:t=parseInt(Math.random()*this.audioAmount)}return t}},{key:"render",value:function(){var e=this,t=this.state,a=t.showFullplayer,n=t.showPlayingList;return i.a.createElement(g.Consumer,null,function(t){var r=t.playerState,l=t.playByIndex,s=t.pause,c=r.playingList,o=r.currentSong,u=r.curSongIndex,d=r.isPause,m=o.id;return m&&(e.diffSong=e.songId!==m,e.songId=m),e.curSongIndex=u,e.audioAmount=c.length,e.isPause=d,e.currentSong=o,e.isToReset=b.a.isEmpty(o),i.a.createElement("div",{className:"audio-controls-panel"},i.a.createElement("audio",{ref:e.audioRef,src:o&&o.link?"".concat(e.songUrlApi).concat(o.id):"",onDurationChange:function(){return e.handleDurationChange()},onTimeUpdate:function(){return e.handleTimeUpdate()},onEnded:function(){return e.handleEnded(l)},onError:function(){return e.handleAudioError()}}),i.a.createElement(E.Transition,{in:!e.isToReset,timeout:150,mountOnEnter:!0,unmountOnExit:!0},function(t){return i.a.createElement($,{transitionClass:"slide-up slide-up-".concat(t),curSong:o,isPauseIcon:e.state.isPauseIcon,clickPlayPauseHandler:function(t){return e.handleClickPlayPause(t,l,s)},toggleFullplayer:e.toggleFullplayer,togglePlayingList:function(t){return e.togglePlayingList(t)}})}),i.a.createElement(E.Transition,{in:!e.isToReset&&a,timeout:250,mountOnEnter:!0,unmountOnExit:!0,onExited:function(){return e.setState({showFullplayer:!1})}},function(t){return i.a.createElement(te,{transitionClass:"slide-up slide-up-".concat(t),curSong:o,diffSong:e.diffSong,playState:e.state,mode:e.playMode[e.state.modeIndex].className,clickPlayPauseHandler:function(t){return e.handleClickPlayPause(t,l,s)},clickPrevBtnHandler:function(){return e.handleClickPrevBtn(l)},clickNextBtnHandler:function(){return e.handleClickNextBtn(l)},clickModeBtnHandler:function(){return e.handleClickModeBtn()},changeProgressHandler:e.handleChangeProgress,afterChangeProgressHandler:e.handleAfterChangeProgress,toggleFullplayer:e.toggleFullplayer,togglePlayingList:function(t){return e.togglePlayingList(t)},updateCurrentTime:e.updateCurrentTime})}),i.a.createElement(E.Transition,{in:!e.isToReset&&n,timeout:250,mountOnEnter:!0,unmountOnExit:!0,onExited:function(){return e.setState({showPlayingList:!1})}},function(t){return i.a.createElement(ne,{transitionClass:"slide-up slide-up-".concat(t),listData:c,curSongIndex:u,togglePlayingList:function(t){return e.togglePlayingList(t)}})}))})}}]),t}(i.a.Component),re=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(u.a)(this,Object(d.a)(t).call(this,e))).play=function(){a.setState({isPause:!1})},a.pause=function(){a.setState({isPause:!0})},a.state={playingList:[],currentSong:{},curSongIndex:-1,isPause:!0,isLogin:!1},a.playByIndex=a.playByIndex.bind(Object(p.a)(Object(p.a)(a))),a.deleteSong=a.deleteSong.bind(Object(p.a)(Object(p.a)(a))),a.clearPlaylist=a.clearPlaylist.bind(Object(p.a)(Object(p.a)(a))),a.playAll=a.playAll.bind(Object(p.a)(Object(p.a)(a))),a.addAll=a.addAll.bind(Object(p.a)(Object(p.a)(a))),a.playSong=a.playSong.bind(Object(p.a)(Object(p.a)(a))),a.addSongToNext=a.addSongToNext.bind(Object(p.a)(Object(p.a)(a))),a}return Object(m.a)(t,e),Object(o.a)(t,[{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("playData");this.setState(JSON.parse(e))}},{key:"componentDidUpdate",value:function(){var e=this.state,t=e.playingList,a=e.currentSong,n=e.curSongIndex;window.localStorage.setItem("playData",JSON.stringify({playingList:t,currentSong:a,curSongIndex:n}))}},{key:"playByIndex",value:function(e){e>=0&&(e===this.state.curSongIndex?this.state.isPause&&this.setState({isPause:!1}):this.setState({currentSong:this.state.playingList[e],curSongIndex:e,isPause:!1}))}},{key:"deleteSong",value:function(e){var t=this.state,a=t.playingList,n=t.curSongIndex;y.a.remove(a,function(t,a){return a===e}),a.length?e<n?this.setState({playingList:a,curSongIndex:n-1}):e===n?(n=e===a.length?0:e,this.setState({playingList:a,currentSong:a[n],curSongIndex:n,isPause:!1})):this.setState({playingList:a}):this.clearPlaylist()}},{key:"clearPlaylist",value:function(){this.setState({playingList:[],currentSong:{},curSongIndex:-1,isPause:!0})}},{key:"playAll",value:function(e){var t=this;this.setState({playingList:e,curSongIndex:-1},function(){return t.playByIndex(0)})}},{key:"addAll",value:function(e){var t=this.state.playingList;if(t.length){var a=y.a.differenceBy(e,t,"id");a.length&&(t.splice.apply(t,[this.state.curSongIndex+1,0].concat(Object(s.a)(a))),this.setState({playingList:t}))}else this.playAll(e)}},{key:"playSong",value:function(e){var t=this,a=this.state,n=a.playingList,i=a.curSongIndex,r=i+1;if(n.length){var l=y.a.findIndex(n,["id",e.id]);-1!==l?l===i?this.playByIndex(l):l<i?(n.splice(r,0,e),n.splice(l,1),this.setState({playingList:n,curSongIndex:i-1},function(){return t.playByIndex(r-1)})):(n.splice(l,1),n.splice(r,0,e),this.setState({playingList:n},function(){return t.playByIndex(r)})):(n.splice(r,0,e),this.setState({playingList:n},function(){return t.playByIndex(r)}))}else this.setState({playingList:[e]},function(){return t.playByIndex(r)})}},{key:"addSongToNext",value:function(e){var t=this,a=this.state,n=a.playingList,i=a.curSongIndex,r=i+1;if(n.length){var l=y.a.findIndex(n,["id",e.id]);-1!==l?l===i?this.playByIndex(l):l<i?(n.splice(r,0,e),n.splice(l,1),this.setState({playingList:n,curSongIndex:i-1})):(n.splice(l,1),n.splice(r,0,e),this.setState({playingList:n})):(n.splice(r,0,e),this.setState({playingList:n}))}else this.setState({playingList:[e]},function(){return t.playByIndex(0)})}},{key:"render",value:function(){return i.a.createElement(g.Provider,{value:{playerState:this.state,playByIndex:this.playByIndex,play:this.play,pause:this.pause,deleteSong:this.deleteSong,clearPlaylist:this.clearPlaylist,playAll:this.playAll,addAll:this.addAll,playSong:this.playSong,addSongToNext:this.addSongToNext}},i.a.createElement(J,null),i.a.createElement(ie,null))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(i.a.createElement(re,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},55:function(e,t,a){e.exports=a.p+"static/media/cover-placeholder.d45643b2.png"}},[[166,2,1]]]);
//# sourceMappingURL=main.43b525ab.chunk.js.map