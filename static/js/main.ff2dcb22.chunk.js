(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{208:function(e,t,a){e.exports=a.p+"static/media/playall.8f22f49d.png"},215:function(e,t,a){e.exports=a(526)},220:function(e,t,a){},395:function(e,t,a){},397:function(e,t,a){},399:function(e,t,a){},417:function(e,t,a){},419:function(e,t,a){},421:function(e,t,a){},489:function(e,t,a){},521:function(e,t,a){},523:function(e,t,a){},526:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),l=a(57),r=a.n(l),s=a(528),o=(a(220),a(214)),c=a(2),u=a(3),d=a(5),m=a(4),p=a(6),h=a(7),y=a(530),g=a(529),f=a(70),v=a.n(f),E=i.a.createContext(),S=(a(181),a(67)),k=a.n(S),b=(a(193),a(68)),w=a.n(b),N=(a(64),a(16)),P=a.n(N),x=a(99),C=a(27),O=a.n(C),j=a(208),L=a.n(j),I=(a(395),function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.src,a=e.style,n=e.playCount;return i.a.createElement("div",{className:"pl-cover",style:a},i.a.createElement("img",{className:"cover",src:t,alt:"cover"}),i.a.createElement("span",{className:"u-earp play-num"},n))}}]),t}(i.a.Component)),A=(a(397),P.a.Item),T=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).initScroll=function(){a.SWrapperRef.current&&(a.scroll=new x.a(a.SWrapperRef.current,{bounce:!1}))},a.refreshScroll=function(){a.scroll&&a.scroll.refresh()},a.destroyScroll=function(){a.scroll.destroy()},a.getPldData=function(){var e="".concat("/react_music_app","/api_mock_data/playlist_detail/all/pl-").concat(a.plID,".json");window.fetch(e).then(function(e){return"OK"===e.statusText?e.json():{}}).then(function(e){a.setState({plDetail:e})}).catch(function(e){return console.log(e)})},a.state={plDetail:{}},a.plID="",a.SWrapperRef=i.a.createRef(),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.initScroll(),this.getPldData()}},{key:"componentDidUpdate",value:function(){this.refreshScroll()}},{key:"componentWillUnmount",value:function(){this.scroll&&this.scroll.destroy()}},{key:"handleClickPlayallOrAddall",value:function(e){e(O.a.cloneDeep(this.state.plDetail.songlist))}},{key:"handlePlaySong",value:function(e,t,a){e.stopPropagation(),t(O.a.cloneDeep(this.state.plDetail.songlist[a]))}},{key:"render",value:function(){var e=this,t=this.props,a=t.match,n=t.location,l=t.history;if(console.log(n),console.log(a),this.plID=n.search.split("=")[1],this.state.plDetail.hasOwnProperty("id")){var r=this.state.plDetail,s=r.coverUrl,o=r.title,c=r.author,u=r.songNum,d=r.playNum,m=r.songlist,p=d>=1e4?"".concat(parseInt(d/1e4),"\u4e07"):d;return i.a.createElement(E.Consumer,null,function(t){var a=t.playerState,n=t.playAll,r=(t.addAll,t.playSong),d=m.map(function(t,a){var n=t.id,l=t.name,s=t.artists,o=t.album,c=s.map(function(e){return e.name}).join("/");return i.a.createElement(A,{key:n,className:"mty-list-item",activeStyle:{backgroundColor:"#ccc"},onClick:function(t){e.handlePlaySong(t,r,a)}},i.a.createElement("div",{className:"s-index"},a+1),i.a.createElement("div",{className:"s-detail-wrap"},i.a.createElement("div",{className:"s-info"},i.a.createElement("div",{className:"s-name f-thide"},l),i.a.createElement("div",{className:"s-artists-alb f-thide"},c," - ",o.name))))});return i.a.createElement("div",{className:"PlaylistDetail"},i.a.createElement(k.a,{className:"my-pld-navbar",icon:i.a.createElement(w.a,{type:"left"}),onLeftClick:function(){return l.goBack()}},"\u6b4c\u5355"),i.a.createElement("div",{ref:e.SWrapperRef,className:"scroll-wrapper",style:a.playingList.length?{paddingBottom:"56px"}:{paddingBottom:"0px"}},i.a.createElement("div",{className:"scroll-content"},i.a.createElement("section",{className:"my-plinfo-wrap"},i.a.createElement(I,{src:"".concat(s,"?param=512y512"),style:{width:"1.12rem",height:"1.12rem"},playCount:p}),i.a.createElement("div",{className:"plinfo-right"},i.a.createElement("h2",{className:"f-brk title"},o),i.a.createElement("div",{className:"author f-thide"},i.a.createElement("div",{className:"avatar"},i.a.createElement("img",{src:c.avatarUrl,alt:"ava"})),c.name))),i.a.createElement("div",{className:"playall-btn-wrapper"},i.a.createElement(A,{className:"mty-list-item",activeStyle:{backgroundColor:"#ddd"},onClick:function(){e.handleClickPlayallOrAddall(n)}},i.a.createElement("div",{className:"playall-btn"},i.a.createElement("img",{src:L.a,alt:"playicon"}),i.a.createElement("span",null,"\u64ad\u653e\u5168\u90e8"),i.a.createElement("span",{className:"song-num"},"\u5171(",u,")\u9996")))),i.a.createElement(P.a,null,d))),i.a.createElement("div",{className:"bg-wrap"},i.a.createElement("div",{className:"fullscreen-blur-bg",style:{backgroundImage:"url(".concat(s,"?param=512y512)")}})))})}return i.a.createElement("div",null)}}]),t}(i.a.Component),B=a(527),R=(a(399),a(401),a(209)),D=a.n(R),_=a(34),U=(a(417),function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement("div",{className:"loading"},i.a.createElement("i",{className:"loading-icon"}),i.a.createElement("p",{className:"loading-text"},"\u6b63\u5728\u52a0\u8f7d"))}}]),t}(i.a.Component)),F=(a(419),P.a.Item),K=F.Brief,H=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).submit=function(e){if(e){a.setState({showSearchKeywordBox:!1,showSearchResultBox:!0,isLoading:!0});var t=a.state.historyKeywords,n=[];t&&t.length?(n=t.slice(0)).push(e):n.push(e);var i=O.a.uniq(n);window.localStorage.setItem("historyKeywords",JSON.stringify(i));var l="https://api.mlwei.com/music/api/wy/?key=523077333&id=".concat(e,"&type=so&cache=0&nu=60"),r=encodeURI(l);window.fetch(r,{method:"GET",headers:{Accept:"*"},mode:"cors"}).then(function(e){return 200===e.status?e.json():{}}).then(function(e){var t=[];e.Body&&(t=e.Body.map(function(e){var t=e.author,a=e.id,n=e.pic,i=e.title;return{id:a,link:"/song?id=".concat(a),name:i,artists:[{name:t}],album:{picUrl:n}}})),a.setState({historyKeywords:i,searchResult:t,isLoading:!1})}).catch(function(e){console.log(e),a.setState({historyKeywords:n,isLoading:!1})})}},a.change=function(e){a.setState({keyword:e})},a.clear=function(){a.setState({keyword:""})},a.focus=function(){console.log("focus"),a.setState({showSearchBox:!0,showSearchKeywordBox:!0,showSearchResultBox:!1,isLoading:!1})},a.cancel=function(){a.setState({keyword:"",showSearchBox:!1,showSearchKeywordBox:!1,showSearchResultBox:!1,isLoading:!1})},a.handlePlaySong=function(e,t,n){e.stopPropagation(),t(O.a.cloneDeep(a.state.searchResult[n]))},a.handleClickKeyword=function(e){e.stopPropagation();var t=e.target.textContent;console.log(t),"item"===e.target.className&&(a.setState({keyword:t}),a.submit(t))},a.clearHistoryKeywords=function(e){e.stopPropagation(),window.localStorage.removeItem("historyKeywords"),a.setState({historyKeywords:[]})},a.state={keyword:"",hotKeywords:["\u8d77\u98ce\u4e86","A\u59b9\u65b0\u4e13\u8f91","\u6709\u53ef\u80fd\u7684\u591c\u665a","\u51fa\u5c71","\u6d41\u6d6a\u5730\u7403","Counting Sheep","\u7a7a\u5fc3","\u6c34\u661f\u8bb0","\u4e1c\u897f","\u68a6\u9f99"],historyKeywords:[],searchResult:[],showSearchBox:!1,showSearchKeywordBox:!1,showSearchResultBox:!1,isLoading:!1},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("historyKeywords");e&&this.setState({historyKeywords:JSON.parse(e)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.hotKeywords,n=t.historyKeywords,l=t.searchResult,r=t.showSearchBox,s=t.showSearchKeywordBox,o=t.showSearchResultBox,c=t.isLoading;return i.a.createElement(E.Consumer,null,function(t){var u,d=t.playSong;return u=l&&l.length?l.map(function(t,a){var n=t.id,l=t.name,r=t.artists;return i.a.createElement(F,{key:n,className:"result-list-item",activeStyle:{backgroundColor:"#ccc"},onClick:function(t){e.handlePlaySong(t,d,a)},multipleLine:!0},l,i.a.createElement(K,null,r.map(function(e){return e.name}).join("/")))}):i.a.createElement("div",{style:{height:"100vh",textAlign:"center"}},"\u7f51\u7edc\u51fa\u4e86\u70b9\u95ee\u9898"),i.a.createElement("div",{className:"my-search"},i.a.createElement(D.a,{ref:function(t){return e.manualFocusInst=t},value:e.state.keyword,cancelText:"\u8fd4\u56de",placeholder:"Search",onSubmit:e.submit,onChange:e.change,onClear:e.clear,onFocus:e.focus,onBlur:function(){return console.log("onBlur")},onCancel:e.cancel}),r?i.a.createElement("div",{className:"search-box"},i.a.createElement(_.Transition,{in:s,timeout:150,mountOnEnter:!0,unmountOnExit:!0},function(t){return i.a.createElement("div",{className:"search-keyword-box fade fade-".concat(t),onClick:function(t){return e.handleClickKeyword(t)}},i.a.createElement("div",{className:"hot-keyword"},i.a.createElement("h4",{className:"title"},"\u70ed\u95e8\u641c\u7d22"),i.a.createElement("ul",null,a.map(function(e,t){return i.a.createElement("li",{key:t,className:"item"},e)}))),n.length>0?i.a.createElement("div",{className:"history-keyword"},i.a.createElement("h4",{className:"title"},"\u641c\u7d22\u5386\u53f2",i.a.createElement("i",{className:"delete-btn",onClick:function(t){return e.clearHistoryKeywords(t)}})),i.a.createElement("ul",null,n.map(function(e,t){return i.a.createElement("li",{key:t,className:"item"},e)}))):null)}),i.a.createElement(_.Transition,{in:o,timeout:150,mountOnEnter:!0,unmountOnExit:!0},function(e){return i.a.createElement("div",{className:"search-result-box fade fade-".concat(e)},c?i.a.createElement(U,null):i.a.createElement(P.a,null,u))})):null)})}}]),t}(n.Component),M=(a(421),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).update=function(){a.slide&&a.slide.destroy(),a.init()},a.refresh=function(){a._setSlideWidth(!0),a.slide.refresh()},a.prev=function(){a.slide.prev()},a.next=function(){a.slide.next()},a.init=function(){window.clearTimeout(a.timer),a.setState({currentPageIndex:0}),a._setSlideWidth(),a.props.showDot&&a._initDots(),a._initSlide(),a.props.autoPlay&&a._play()},a._setSlideWidth=function(e){a.children=a.slideGroupRef.current.children;for(var t=0,n=a.slideRef.current.clientWidth,i=0;i<a.children.length;i++){var l=a.children[i];a.addClass(l,"slide-item"),l.style.width=n+"px",t+=n}a.props.loop&&!e&&(t+=2*n),a.slideGroupRef.current.style.width=t+"px"},a._initSlide=function(){console.log(a.props.threshold),a.slide=new x.a(a.slideRef.current,{scrollX:!0,scrollY:!1,momentum:!1,snap:{loop:a.props.loop,threshold:a.props.threshold,speed:a.props.speed},bounce:!1,stopPropagation:!0,click:a.props.click}),a.slide.on("scrollEnd",a._onScrollEnd),a.slide.on("touchEnd",function(){a.props.autoPlay&&a._play()}),a.slide.on("beforeScrollStart",function(){a.props.autoPlay&&window.clearTimeout(a.timer)})},a._onScrollEnd=function(){var e=a.slide.getCurrentPage().pageX;a.setState({currentPageIndex:e}),a.autoPlay&&a._play()},a._initDots=function(){for(var e=new Array(a.children.length),t=0;t<e.length;t++)e[t]=t;a.setState({dots:e})},a._play=function(){window.clearTimeout(a.timer),a.timer=window.setInterval(function(){a.slide.next()},a.props.interval)},a.hasClass=function(e,t){return new RegExp("(^|\\s)"+t+"(\\s|$)").test(e.className)},a.addClass=function(e,t){if(!a.hasClass(e,t)){var n=e.className.split(" ");n.push(t),e.className=n.join(" ")}},a.state={dots:[],currentPageIndex:0},a.slideRef=i.a.createRef(),a.slideGroupRef=i.a.createRef(),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.update(),window.addEventListener("resize",function(){e.slide&&e.slide.enabled&&(window.clearTimeout(e.resizeTimer),e.resizeTimer=window.setTimeout(function(){e.slide.isInTransition?e._onScrollEnd():e.props.autoPlay&&e._play(),e.refresh()},60))})}},{key:"componentWillMount",value:function(){window.clearTimeout(this.timer)}},{key:"render",value:function(){var e=this.state,t=e.dots,a=e.currentPageIndex;return i.a.createElement("div",{className:"slide",ref:this.slideRef},i.a.createElement("div",{className:"slide-group",ref:this.slideGroupRef},this.props.children),this.props.showDot?i.a.createElement("div",{className:"dots"},t.map(function(e,t){return i.a.createElement("span",{key:t,className:"dot ".concat(a===t?"active":"")})})):null)}}]),t}(n.Component));M.defaultProps={loop:!0,autoPlay:!0,interval:4e3,showDot:!0,click:!0,threshold:.3,speed:400};var W=M,G=function(e){function t(){var e,a;Object(c.a)(this,t);for(var n=arguments.length,i=new Array(n),l=0;l<n;l++)i[l]=arguments[l];return(a=Object(d.a)(this,(e=Object(m.a)(t)).call.apply(e,[this].concat(i)))).state={banners:["https://p1.music.126.net/PzonwsvcSEEsr-uhJXE2_g==/109951163871296308.jpg","https://p1.music.126.net/thHP6ooWw893Ccfk_iXG5w==/109951163866743145.jpg","https://p1.music.126.net/VO_0urbXu_PytHjhjfj4Zw==/109951163871298888.jpg","https://p1.music.126.net/kEGOOxh_p6H7UHKuOOFkFg==/109951163871789068.jpg","https://p1.music.126.net/wa7Oxq5yysZgGBvOlivwEg==/109951163871318124.jpg"]},a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.state.banners;return i.a.createElement(W,null,e.map(function(e,t){return i.a.createElement("div",{key:t},i.a.createElement("img",{src:e,alt:"banner"}))}))}}]),t}(n.Component),Z=P.a.Item,J=Z.Brief,z=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).getPlaylists=function(e){var t="".concat("/react_music_app","/api_mock_data/playlists/all/p").concat(e,".json");window.fetch(t).then(function(e){return 200===e.status?e.json():""}).then(function(e){a.setState({playlists:e})}).catch(function(e){return console.log(e)})},a.state={rcmdPlaylists:[{id:2406347748,coverUrl:"http://p2.music.126.net/tkQ6Zb_eBdUsFAeD6PM-2A==/109951163547241213.jpg",name:"2018\u5168\u7f8e\u97f3\u4e50\u5956\u63d0\u540d\u540d\u5355\uff08AMAs\uff09",link:"/playlist?id=2406347748",playCount:"126\u4e07",author:{name:"DoubleRainbow_",homeLink:"/user/home?id=3226705"}},{id:2439954234,coverUrl:"http://p2.music.126.net/dBdq_Rs_pexuA8GqkZLcKA==/109951163599919632.jpg",name:"\u542c\u9996\u60c5\u6b4c\u8bf4\u5531 | \u505a\u4e2a\u751c\u751c\u7684\u68a6",link:"/playlist?id=2439954234",playCount:"211\u4e07",author:{name:"\u7ae0\u82e5\u6960nn",homeLink:"/user/home?id=640698142"}},{id:2497731034,coverUrl:"http://p2.music.126.net/AtlN3uAvGczoL-xQN7FTtQ==/109951163643083559.jpg",name:"\u521d\u604b\u7cd6\u914d\u6599\u8868\uff1a\u4f60\u7684\u9a6c\u5c3e\u8fab\u548c\u886c\u886b\u5473\u9053",link:"/playlist?id=2497731034",playCount:"542\u4e07",author:{name:"\u9a74\u5b50\u9b3c",homeLink:"/user/home?id=246029257"}},{id:2390539027,coverUrl:"http://p2.music.126.net/8BZpZdDiDZatIiQMJnoKyg==/109951163736178562.jpg",name:"\u90a3\u4e9b\u8d85\u5e26\u611f\u7684\u82f1\u6587\u6b4c\u66f2~\u300e\u4e00\u79d2\u6ca6\u9677\u300f",link:"/playlist?id=2390539027",playCount:"351\u4e07",author:{name:"Mysterious-Box",homeLink:"/user/home?id=1558934331"}},{id:2554253084,coverUrl:"http://p2.music.126.net/mP8ulkyTDGmoj6jlZ_sblQ==/109951163722284832.jpg",name:"Future Bass\u4e28\u9189\u5bfb\u5fc3\u6da7\u8df3\u52a8\u7684\u68a6\u5e7b\u7535\u5b50\u26a1\ufe0f",link:"/playlist?id=2554253084",playCount:"61\u4e07",author:{name:"Kirin\u7535\u5b50\u7ad9",homeLink:"/user/home?id=1489420441"}},{id:2312165875,coverUrl:"http://p2.music.126.net/Cl0-NpZ0ESTDjJ1HmZ33KA==/109951163460576279.jpg",name:"100\u9996\u534e\u8bed\u6c11\u8c23\uff0c\u56e0\u4e3a\u61c2\u5f97\u624d\u6709\u5171\u9e23",link:"/playlist?id=2312165875",playCount:"1107\u4e07",author:{name:"\u60c5\u601d\u5929\u9e45",homeLink:"/user/home?id=108952364"}}],playlists:[]},a.curPage=0,a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.getPlaylists(this.curPage)}},{key:"render",value:function(){var e=this.props.history,t=this.state,a=t.rcmdPlaylists,n=t.playlists,l=a.map(function(e){var t=e.id,a=e.coverUrl,n=e.name,l=e.link,r=e.playCount;return i.a.createElement(B.a,{key:t,className:"pl-li",to:l},i.a.createElement("div",{className:"cover-wrapper"},i.a.createElement(I,{src:"".concat(a,"?param=512y512"),style:{position:"absolute",top:0,left:0},playCount:r})),i.a.createElement("p",{className:"dec"},n))}),r=n&&n.map(function(t){var a=t.id,n=t.coverUrl,l=t.name,r=t.link,s=t.playCount,o=t.author;return i.a.createElement(Z,{key:a,thumb:"".concat(n,"?param=512y512"),onClick:function(){return e.push(r)},multipleLine:!0},l," ",i.a.createElement(J,null,"".concat(o.name," \xb7 ").concat(s,"\u6b21\u64ad\u653e")))});return i.a.createElement(E.Consumer,null,function(e){var t=e.playerState;return i.a.createElement(i.a.Fragment,null,i.a.createElement(H,null),i.a.createElement("div",{className:"playlists",style:t.playingList.length?{paddingBottom:"56px"}:{paddingBottom:"0px"}},i.a.createElement(G,null),i.a.createElement("div",{key:"cate",className:"pl-cat"},"\u63a8\u8350\u6b4c\u5355"),i.a.createElement("div",{key:"cvrlst",className:"pl-cvrlst"},l),i.a.createElement(P.a,{renderHeader:function(){return"\u5168\u90e8\u6b4c\u5355"}},r)))})}}]),t}(i.a.Component),Q=a(210),X=a.n(Q),q=a(69),V=a.n(q),Y=(a(489),P.a.Item),$=Y.Brief,ee=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.transitionClass,a=e.curSong,n=e.isPauseIcon,l=e.clickPlayPauseHandler,r=e.toggleFullplayer,s=e.togglePlayingList,o=i.a.createElement("div",{className:"miniplayer-btns-wrapper"},i.a.createElement("div",{className:"btn ".concat(n?"pause":"play","-icon"),onClick:l}),i.a.createElement("div",{className:"btn playlist-icon",onClick:s})),c=null;if(O.a.isEmpty(a))c=i.a.createElement(Y,{className:"miniplayer-content",extra:o,multipleLine:!0},"\u542c\u6211\u60f3\u542c\u7684\u6b4c");else{var u=a.name,d=a.artists,m=a.album,p="";p=m.picUrl&&m.picUrl.length&&m.picUrl.includes("http")?"".concat(m.picUrl):V.a,c=i.a.createElement(Y,{className:"miniplayer-content",thumb:p,extra:o,onClick:r,activeStyle:{backgroundColor:"#fff"},multipleLine:!0},u,i.a.createElement($,null,d.map(function(e){return e.name}).join("/")))}return i.a.createElement("div",{className:"miniplayer ".concat(t)},c)}}]),t}(n.Component),te=(a(491),a(211)),ae=a.n(te),ne=(a(521),function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).getLyric=function(){var e="https://api.mlwei.com/music/api/wy/?key=523077333&cache=1&type=lrc&id=".concat(a.songId);console.log(e),window.fetch(e,{method:"GET",headers:{Accept:"*"},mode:"cors"}).then(function(e){return console.log(e),200===e.status?e.text():null}).then(function(e){if(e){console.log(e);var t=e.split("\n"),n=[],i=[];t.forEach(function(e){var t=e.match(/\[(.*)\](.*)/);if(t){var a=t[1].trim().split(":"),l=60*parseInt(a[0])+parseFloat(a[1]);isNaN(l)||(n.push(t[2].trim()),i.push(l))}}),console.log(n),console.log(i),a.setState({lyric:n,timestampArr:i,curLyricIndex:0})}}).catch(function(e){console.log(e),a.setState({lyric:[],timestampArr:[]})})},a.handleClickLyric=function(){a.setState({showCover:!0,showLyric:!1})},a.handleClickCover=function(){a.setState({showCover:!1,showLyric:!0})},a.state={lyric:[],timestampArr:[],showCover:!0,showLyric:!1},a.songId=0,a.diffSong=!1,a.curLyricIndex=-1,a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){this.getLyric()}},{key:"componentDidUpdate",value:function(){this.diffSong&&this.getLyric()}},{key:"render",value:function(){var e=this,t=this.props,a=t.transitionClass,n=t.curSong,l=t.playState,r=t.mode,s=t.clickPlayPauseHandler,o=t.clickPrevBtnHandler,c=t.clickNextBtnHandler,u=t.clickModeBtnHandler,d=t.changeProgressHandler,m=t.afterChangeProgressHandler,p=t.toggleFullplayer,h=t.togglePlayingList,y=this.state,g=y.lyric,f=y.timestampArr,v=y.showCover,S=y.showLyric;if(O.a.isEmpty(n))return i.a.createElement("div",{className:"fullplayer ".concat(a)},i.a.createElement(k.a,{className:"my-fullplayer-navbar",icon:i.a.createElement(w.a,{type:"down"}),onLeftClick:p},"\u542c\u6211\u60f3\u542c\u7684\u6b4c"),i.a.createElement("div",{className:"mid-wrapper"},i.a.createElement("div",{className:"cd-box"},i.a.createElement("div",{className:"cd-wrapper"},i.a.createElement("div",{className:"cd"},i.a.createElement("img",{className:"image",src:V.a}))))),i.a.createElement("div",{className:"background"}));var b=n.id,N=n.name,P=n.artists,x=n.album,C=l.duration,j=l.curTime,L=l.playProgress,I=l.isPauseIcon,A=l.curTimestamp;this.diffSong=this.songId!==b,this.songId=b;var T=i.a.createElement("div",{className:"navbar-title-content"},i.a.createElement("p",{className:"song-name f-thide"},N),i.a.createElement("p",{className:"artists-name f-thide"},"- ",P.map(function(e){return e.name}).join("/")," -")),B=0,R=null,D=0,U=0;g.length&&(B=O.a.findLastIndex(f,function(e){return e<A}),this.curLyricIndex=B,R=g.map(function(e,t){var a="sentence".concat(t===B?" is-curSentence":"");return i.a.createElement("p",{id:t,key:t,style:""===e?{height:"18px"}:{},className:a},e)}),D=128-40*B,U=128-40*g.length,D<U&&(D=U));var F="";F=x.picUrl&&x.picUrl.length&&x.picUrl.includes("http")?"".concat(x.picUrl):V.a;var K=parseFloat(L);return i.a.createElement(E.Consumer,null,function(t){var n=t.playerState,l=t.play,y=t.pause,g=n.curSongIndex;return i.a.createElement("div",{className:"fullplayer ".concat(a)},i.a.createElement(k.a,{className:"my-fullplayer-navbar",icon:i.a.createElement(w.a,{type:"down"}),onLeftClick:p},T),i.a.createElement("div",{className:"mid-wrapper"},i.a.createElement(_.Transition,{in:v,timeout:200,mountOnEnter:!0,unmountOnExit:!0},function(t){return i.a.createElement("div",{className:"cd-box fade fade-".concat(t),onClick:function(){return e.handleClickCover()}},i.a.createElement("div",{className:"cd-wrapper"},i.a.createElement("div",{className:"cd"},i.a.createElement("img",{className:"image",src:F}))))}),i.a.createElement(_.Transition,{in:S,timeout:200,mountOnEnter:!0,unmountOnExit:!0},function(t){return i.a.createElement("div",{className:"lyric-box fade fade-".concat(t),onClick:function(){return e.handleClickLyric()}},R?i.a.createElement("div",{className:"lyric",style:{transition:"transform 0.35s ease-out 0s",transform:"translateY(".concat(D,"px)")}},R):i.a.createElement("p",{className:"no-lyric"},"\u6682\u65e0\u6b4c\u8bcd"))})),i.a.createElement("div",{className:"btm-wrapper"},i.a.createElement("div",{className:"progress-wrapper"},i.a.createElement("p",{className:"time time-cur"},j),i.a.createElement(ae.a,{style:{marginLeft:12,marginRight:12,paddingTop:22,paddingBottom:24},defaultValue:0,min:0,max:100,step:.1,value:K,handleStyle:{marginLeft:"-8px",marginTop:"-7px",width:"16px",height:"16px",border:"none"},trackStyle:{backgroundColor:"#ffd426"},railStyle:{backgroundColor:"rgba(225,225,225, 0.4)"},onChange:function(e){y(),d(e)},onAfterChange:function(e){m(e),l(g)}}),i.a.createElement("p",{className:"time time-dur"},C)),i.a.createElement("div",{className:"operators"},i.a.createElement("div",{className:"btn ".concat(r,"-icon"),onClick:u}),i.a.createElement("div",{className:"btn prev-icon",onClick:o}),i.a.createElement("div",{className:"btn ".concat(I?"pause":"play","-icon"),onClick:s}),i.a.createElement("div",{className:"btn next-icon",onClick:c}),i.a.createElement("div",{className:"btn list-icon",onClick:h}))),i.a.createElement("div",{className:"background"},i.a.createElement("img",{width:"100%",height:"100%",src:F})))})}}]),t}(i.a.Component)),ie=(a(523),P.a.Item),le=function(e){function t(){return Object(c.a)(this,t),Object(d.a)(this,Object(m.a)(t).apply(this,arguments))}return Object(p.a)(t,e),Object(u.a)(t,[{key:"render",value:function(){var e=this.props,t=e.transitionClass,a=e.togglePlayingList;return i.a.createElement(E.Consumer,null,function(e){var n=e.playerState,l=e.play,r=e.deleteSong,s=e.clearPlaylist,o=n.playingList,c=n.curSongIndex,u=i.a.createElement("div",{className:"btn delete-icon",onClick:function(){return s()}}),d=o.map(function(e,t){var a=e.id,n=e.name,s=e.artists,o=i.a.createElement("div",{className:"btn close-icon",onClick:function(e){e.stopPropagation(),r(t)}});return i.a.createElement(ie,{key:a,className:"".concat(c===t?"active-song":""),extra:o,onClick:function(){return l(t)}},n,i.a.createElement("span",{className:"song-artists-alb"}," - "+s.map(function(e){return e.name}).join("/")))});return i.a.createElement("div",{className:"playing-list ".concat(t),onTouchStart:function(e){return e.stopPropagation()}},i.a.createElement(ie,{extra:u,multipleLine:!0},"\u64ad\u653e\u5217\u8868",i.a.createElement("span",{className:"song-num"},"\u5171(",o.length,")\u9996")),i.a.createElement(P.a,null,d),i.a.createElement(ie,{className:"close-btn",onClick:a,multipleLine:!0},"\u5173\u95ed"))})}}]),t}(i.a.Component),re=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).toggleFullplayer=function(){a.setState(function(e){return{showFullplayer:!e.showFullplayer}})},a.togglePlayingList=function(e){e.stopPropagation(),a.setState(function(e){return{showPlayingList:!e.showPlayingList}})},a.state={modeIndex:0,duration:"00:00",curTime:"00:00",playProgress:"0",curTimestamp:0,isPauseIcon:!1,showFullplayer:!1,showPlayingList:!1},a.audioRef=i.a.createRef(),a.handleChangeProgress=a.handleChangeProgress.bind(Object(h.a)(Object(h.a)(a))),a.handleAfterChangeProgress=a.handleAfterChangeProgress.bind(Object(h.a)(Object(h.a)(a))),a.curSongIndex=-1,a.audioAmount=0,a.isPause=!0,a.songUrlApi="https://music.163.com/song/media/outer/url?id=",a.currentSong={},a.playMode=[{desc:"\u5217\u8868\u5faa\u73af",className:"loop"},{desc:"\u5355\u66f2\u5faa\u73af",className:"single"},{desc:"\u968f\u673a\u64ad\u653e",className:"random"}],a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidUpdate",value:function(){console.log("componentDidUpdate"),this.isNoAudio()||(this.isPause?this.audioRef.current.paused||this.pauseAudio():this.audioRef.current.paused&&this.playAudio())}},{key:"playAudio",value:function(){var e=this;this.audioRef.current.play().then(function(){console.log("play.then"),e.setState({isPauseIcon:!0})},function(e){console.log(e)})}},{key:"pauseAudio",value:function(){this.audioRef.current.pause(),this.setState({isPauseIcon:!1})}},{key:"handleClickPlayPause",value:function(e,t,a){(e.stopPropagation(),this.isNoAudio())||(this.audioRef.current.paused?t(this.curSongIndex):a())}},{key:"handleClickPrevBtn",value:function(e){this.isNoAudio()||(this.setState({playProgress:"0"}),e(this.getIndex(!0)))}},{key:"handleClickNextBtn",value:function(e){this.isNoAudio()||(this.setState({playProgress:"0"}),e(this.getIndex()))}},{key:"handleClickModeBtn",value:function(){if(!this.isNoAudio()){var e=(this.state.modeIndex+1)%this.playMode.length;this.audioRef.current.loop=1===e,this.setState({modeIndex:e})}}},{key:"handleChangeProgress",value:function(e){if(!this.isNoAudio()){var t=this.state.curTime,a=this.audioRef.current.duration,n=this.timeFormat(parseFloat((e/100*a).toFixed(6))),i="".concat(e,"%");t!==n?this.setState({curTime:n,playProgress:i}):this.setState({playProgress:i})}}},{key:"handleAfterChangeProgress",value:function(e){if(!this.isNoAudio()){var t=this.audioRef.current;t.currentTime=parseFloat((e/100*t.duration).toFixed(6))}}},{key:"handleDurationChange",value:function(){console.log("handleDurationChange"),this.setState({duration:this.timeFormat(this.audioRef.current.duration),playProgress:"0",curTime:"00:00"})}},{key:"handleTimeUpdate",value:function(){var e=this.state.curTime,t=this.audioRef.current.duration,a=this.audioRef.current.currentTime,n=this.timeFormat(a),i="".concat((a/t*100).toFixed(2),"%");e!==n?this.setState({curTime:n,playProgress:i,curTimestamp:a}):a===t?this.setState({playProgress:i,curTimestamp:a}):this.setState({curTimestamp:a})}},{key:"handleEnded",value:function(e){var t=this.getIndex();this.setState({loadProgress:"0",playProgress:"0"}),e(t)}},{key:"handleAudioError",value:function(){var e=this.audioRef.current;console.log(e.error),2===e.error.code&&(e.load(),e.currentTime=parseFloat(this.state.playProgress)/100,console.log(this.state.playProgress))}},{key:"isNoAudio",value:function(){return 0===this.audioAmount}},{key:"timeFormat",value:function(e){var t=parseInt("".concat(e/60)),a=parseInt("".concat(e%60)),n=t<10?"0".concat(t):"".concat(t),i=a<10?"0".concat(a):"".concat(a);return"".concat(n,":").concat(i)}},{key:"getIndex",value:function(e){void 0===e&&(e=!1);var t=0;switch(this.state.modeIndex){case 0:case 1:t=e?(this.curSongIndex-1+this.audioAmount)%this.audioAmount:(this.curSongIndex+1)%this.audioAmount;break;case 2:t=parseInt(Math.random()*this.audioAmount)}return t}},{key:"render",value:function(){var e=this,t=this.state,a=t.showFullplayer,n=t.showPlayingList;return i.a.createElement(E.Consumer,null,function(t){var l=t.playerState,r=t.play,s=t.pause,o=(t.deleteSong,t.clearPlaylist,l.playingList),c=l.currentSong,u=l.curSongIndex,d=l.isPause;return e.curSongIndex=u,e.audioAmount=o.length,e.isPause=d,e.currentSong=c,e.isToReset=X.a.isEmpty(c),i.a.createElement("div",{className:"audio-controls-panel"},i.a.createElement("audio",{ref:e.audioRef,src:c&&c.link?"".concat(e.songUrlApi).concat(c.id):"",onDurationChange:function(){return e.handleDurationChange()},onTimeUpdate:function(){return e.handleTimeUpdate()},onEnded:function(){return e.handleEnded(r)},onError:function(){return e.handleAudioError()}}),i.a.createElement(_.Transition,{in:!e.isToReset,timeout:150,mountOnEnter:!0,unmountOnExit:!0},function(t){return i.a.createElement(ee,{transitionClass:"slide-up slide-up-".concat(t),curSong:c,isPauseIcon:e.state.isPauseIcon,clickPlayPauseHandler:function(t){return e.handleClickPlayPause(t,r,s)},toggleFullplayer:e.toggleFullplayer,togglePlayingList:function(t){return e.togglePlayingList(t)}})}),i.a.createElement(_.Transition,{in:!e.isToReset&&a,timeout:250,mountOnEnter:!0,unmountOnExit:!0,onExited:function(){return e.setState({showFullplayer:!1})}},function(t){return i.a.createElement(ne,{transitionClass:"slide-up slide-up-".concat(t),curSong:c,playState:e.state,mode:e.playMode[e.state.modeIndex].className,clickPlayPauseHandler:function(t){return e.handleClickPlayPause(t,r,s)},clickPrevBtnHandler:function(){return e.handleClickPrevBtn(r)},clickNextBtnHandler:function(){return e.handleClickNextBtn(r)},clickModeBtnHandler:function(){return e.handleClickModeBtn()},changeProgressHandler:e.handleChangeProgress,afterChangeProgressHandler:e.handleAfterChangeProgress,toggleFullplayer:e.toggleFullplayer,togglePlayingList:function(t){return e.togglePlayingList(t)}})}),i.a.createElement(_.Transition,{in:!e.isToReset&&n,timeout:250,mountOnEnter:!0,unmountOnExit:!0,onExited:function(){return e.setState({showPlayingList:!1})}},function(t){return i.a.createElement(le,{transitionClass:"slide-up slide-up-".concat(t),listData:o,curSongIndex:u,togglePlayingList:function(t){return e.togglePlayingList(t)}})}))})}}]),t}(i.a.Component),se=function(e){function t(e){var a;return Object(c.a)(this,t),(a=Object(d.a)(this,Object(m.a)(t).call(this,e))).state={playingList:[],currentSong:{},curSongIndex:-1,isPause:!0,isLogin:!1},a.play=a.play.bind(Object(h.a)(Object(h.a)(a))),a.pause=a.pause.bind(Object(h.a)(Object(h.a)(a))),a.deleteSong=a.deleteSong.bind(Object(h.a)(Object(h.a)(a))),a.clearPlaylist=a.clearPlaylist.bind(Object(h.a)(Object(h.a)(a))),a.playAll=a.playAll.bind(Object(h.a)(Object(h.a)(a))),a.addAll=a.addAll.bind(Object(h.a)(Object(h.a)(a))),a.playSong=a.playSong.bind(Object(h.a)(Object(h.a)(a))),a.addSongToNext=a.addSongToNext.bind(Object(h.a)(Object(h.a)(a))),a}return Object(p.a)(t,e),Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=window.localStorage.getItem("playData");this.setState(JSON.parse(e))}},{key:"componentDidUpdate",value:function(){var e=this.state,t=e.playingList,a=e.currentSong,n=e.curSongIndex;window.localStorage.setItem("playData",JSON.stringify({playingList:t,currentSong:a,curSongIndex:n}))}},{key:"play",value:function(e){e>=0&&(e===this.state.curSongIndex?this.state.isPause&&this.setState({isPause:!1}):this.setState({currentSong:this.state.playingList[e],curSongIndex:e,isPause:!1}))}},{key:"pause",value:function(){this.setState({isPause:!0})}},{key:"deleteSong",value:function(e){var t=this.state,a=t.playingList,n=t.curSongIndex;v.a.remove(a,function(t,a){return a===e}),a.length?e<n?this.setState({playingList:a,curSongIndex:n-1}):e===n?(n=e===a.length?0:e,this.setState({playingList:a,currentSong:a[n],curSongIndex:n,isPause:!1})):this.setState({playingList:a}):this.clearPlaylist()}},{key:"clearPlaylist",value:function(){this.setState({playingList:[],currentSong:{},curSongIndex:-1,isPause:!0})}},{key:"playAll",value:function(e){var t=this;this.setState({playingList:e,curSongIndex:-1},function(){return t.play(0)})}},{key:"addAll",value:function(e){var t=this.state.playingList;if(t.length){var a=v.a.differenceBy(e,t,"id");console.log(a),a.length&&(t.splice.apply(t,[this.state.curSongIndex+1,0].concat(Object(o.a)(a))),this.setState({playingList:t}))}else this.playAll(e)}},{key:"playSong",value:function(e){var t=this,a=this.state,n=a.playingList,i=a.curSongIndex,l=i+1;if(n.length){var r=v.a.findIndex(n,["id",e.id]);-1!==r?r===i?this.play(r):r<i?(n.splice(l,0,e),n.splice(r,1),this.setState({playingList:n,curSongIndex:i-1},function(){return t.play(l-1)})):(n.splice(r,1),n.splice(l,0,e),this.setState({playingList:n},function(){return t.play(l)})):(n.splice(l,0,e),console.log(n),this.setState({playingList:n},function(){return t.play(l)}))}else this.setState({playingList:[e]},function(){return t.play(l)})}},{key:"addSongToNext",value:function(e){var t=this,a=this.state,n=a.playingList,i=a.curSongIndex,l=i+1;if(n.length){var r=v.a.findIndex(n,["id",e.id]);-1!==r?r===i?this.play(r):r<i?(n.splice(l,0,e),n.splice(r,1),this.setState({playingList:n,curSongIndex:i-1})):(n.splice(r,1),n.splice(l,0,e),this.setState({playingList:n})):(n.splice(l,0,e),this.setState({playingList:n}))}else this.setState({playingList:[e]},function(){return t.play(0)})}},{key:"render",value:function(){return i.a.createElement(E.Provider,{value:{playerState:this.state,play:this.play,pause:this.pause,deleteSong:this.deleteSong,clearPlaylist:this.clearPlaylist,playAll:this.playAll,addAll:this.addAll,playSong:this.playSong,addSongToNext:this.addSongToNext}},i.a.createElement(y.a,null,i.a.createElement(g.a,{path:"/playlist",component:T}),i.a.createElement(g.a,{component:z})),i.a.createElement(re,null))}}]),t}(i.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));r.a.render(i.a.createElement(s.a,null,i.a.createElement(se,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},69:function(e,t,a){e.exports=a.p+"static/media/cover-placeholder.d45643b2.png"}},[[215,2,1]]]);
//# sourceMappingURL=main.ff2dcb22.chunk.js.map